{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar tslib_1 = require(\"tslib\");\nvar Semaphore = /** @class */function () {\n  function Semaphore(_maxConcurrency) {\n    this._maxConcurrency = _maxConcurrency;\n    this._queue = [];\n    if (_maxConcurrency <= 0) {\n      throw new Error('semaphore must be initialized to a positive value');\n    }\n    this._value = _maxConcurrency;\n  }\n  Semaphore.prototype.acquire = function () {\n    var _this = this;\n    var locked = this.isLocked();\n    var ticket = new Promise(function (r) {\n      return _this._queue.push(r);\n    });\n    if (!locked) this._dispatch();\n    return ticket;\n  };\n  Semaphore.prototype.runExclusive = function (callback) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var _a, value, release;\n      return tslib_1.__generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            return [4 /*yield*/, this.acquire()];\n          case 1:\n            _a = _b.sent(), value = _a[0], release = _a[1];\n            _b.label = 2;\n          case 2:\n            _b.trys.push([2,, 4, 5]);\n            return [4 /*yield*/, callback(value)];\n          case 3:\n            return [2 /*return*/, _b.sent()];\n          case 4:\n            release();\n            return [7 /*endfinally*/];\n          case 5:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  Semaphore.prototype.isLocked = function () {\n    return this._value <= 0;\n  };\n  Semaphore.prototype.release = function () {\n    if (this._maxConcurrency > 1) {\n      throw new Error('this method is unavailabel on semaphores with concurrency > 1; use the scoped release returned by acquire instead');\n    }\n    if (this._currentReleaser) {\n      var releaser = this._currentReleaser;\n      this._currentReleaser = undefined;\n      releaser();\n    }\n  };\n  Semaphore.prototype._dispatch = function () {\n    var _this = this;\n    var nextConsumer = this._queue.shift();\n    if (!nextConsumer) return;\n    var released = false;\n    this._currentReleaser = function () {\n      if (released) return;\n      released = true;\n      _this._value++;\n      _this._dispatch();\n    };\n    nextConsumer([this._value--, this._currentReleaser]);\n  };\n  return Semaphore;\n}();\nexports.default = Semaphore;","map":{"version":3,"names":["Object","defineProperty","exports","value","tslib_1","require","Semaphore","_maxConcurrency","_queue","Error","_value","prototype","acquire","_this","locked","isLocked","ticket","Promise","r","push","_dispatch","runExclusive","callback","__awaiter","_a","release","__generator","_b","label","sent","trys","_currentReleaser","releaser","undefined","nextConsumer","shift","released","default"],"sources":["C:/Users/hp/OneDrive/Desktop/Artica/artica-repo/frontend/node_modules/async-mutex/lib/Semaphore.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar tslib_1 = require(\"tslib\");\r\nvar Semaphore = /** @class */ (function () {\r\n    function Semaphore(_maxConcurrency) {\r\n        this._maxConcurrency = _maxConcurrency;\r\n        this._queue = [];\r\n        if (_maxConcurrency <= 0) {\r\n            throw new Error('semaphore must be initialized to a positive value');\r\n        }\r\n        this._value = _maxConcurrency;\r\n    }\r\n    Semaphore.prototype.acquire = function () {\r\n        var _this = this;\r\n        var locked = this.isLocked();\r\n        var ticket = new Promise(function (r) { return _this._queue.push(r); });\r\n        if (!locked)\r\n            this._dispatch();\r\n        return ticket;\r\n    };\r\n    Semaphore.prototype.runExclusive = function (callback) {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _a, value, release;\r\n            return tslib_1.__generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0: return [4 /*yield*/, this.acquire()];\r\n                    case 1:\r\n                        _a = _b.sent(), value = _a[0], release = _a[1];\r\n                        _b.label = 2;\r\n                    case 2:\r\n                        _b.trys.push([2, , 4, 5]);\r\n                        return [4 /*yield*/, callback(value)];\r\n                    case 3: return [2 /*return*/, _b.sent()];\r\n                    case 4:\r\n                        release();\r\n                        return [7 /*endfinally*/];\r\n                    case 5: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Semaphore.prototype.isLocked = function () {\r\n        return this._value <= 0;\r\n    };\r\n    Semaphore.prototype.release = function () {\r\n        if (this._maxConcurrency > 1) {\r\n            throw new Error('this method is unavailabel on semaphores with concurrency > 1; use the scoped release returned by acquire instead');\r\n        }\r\n        if (this._currentReleaser) {\r\n            var releaser = this._currentReleaser;\r\n            this._currentReleaser = undefined;\r\n            releaser();\r\n        }\r\n    };\r\n    Semaphore.prototype._dispatch = function () {\r\n        var _this = this;\r\n        var nextConsumer = this._queue.shift();\r\n        if (!nextConsumer)\r\n            return;\r\n        var released = false;\r\n        this._currentReleaser = function () {\r\n            if (released)\r\n                return;\r\n            released = true;\r\n            _this._value++;\r\n            _this._dispatch();\r\n        };\r\n        nextConsumer([this._value--, this._currentReleaser]);\r\n    };\r\n    return Semaphore;\r\n}());\r\nexports.default = Semaphore;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}